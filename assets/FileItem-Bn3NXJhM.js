import{r as p,j as e,M as N,aF as g,A as v,p as w,aZ as k,T as y,a4 as C,a5 as F}from"./index-D-cHbBwn.js";import{R as I}from"./RecurrenceEditor-rLx-RXEn.js";import{g as T,f as b}from"./dateFormatter-CUKId3Gl.js";const E=s=>s?["image/","application/pdf","text/"].some(a=>s.startsWith(a)):!1,$=({isOpen:s,onClose:l,onSave:a,file:c,hideDateFields:m=!1})=>{const[r,d]=p.useState(null);p.useEffect(()=>{c&&d({...c})},[c]);const j=n=>{d(o=>({...o,...n}))},h=(n,o)=>{d(x=>x?{...x,[n]:o}:null)},i=()=>{r?.name?.trim()&&(a(r),l())};return!s||!c||!r?null:e.jsxs(N,{isOpen:s,onClose:l,title:"עריכת פרטי קובץ",children:[e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"label-class",children:"שם הקובץ"}),e.jsx("input",{type:"text",value:r.name||"",onChange:n=>h("name",n.target.value),className:"input-class"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"label-class",children:"קבוצה"}),e.jsx("input",{type:"text",value:r.group||"",onChange:n=>h("group",n.target.value),className:"input-class"})]}),!m&&e.jsx(I,{type:"file",details:r,onUpdate:j}),e.jsxs("div",{className:"flex justify-end gap-2 pt-4",children:[e.jsx("button",{type:"button",onClick:l,className:"btn-secondary",children:"ביטול"}),e.jsx("button",{type:"button",onClick:i,className:"btn-primary",children:"שמור"})]})]}),e.jsx("style",{children:".label-class { display: block; margin-bottom: 0.25rem; font-size: 0.875rem; font-weight: 500; color: #334155; } .input-class { display: block; width: 100%; border: 1px solid #cbd5e1; border-radius: 0.375rem; padding: 0.5rem 0.75rem; } .btn-primary { padding: 0.5rem 1rem; background-color: #0284c7; color: white; border-radius: 0.375rem; font-weight: 500; } .btn-primary:hover { background-color: #0369a1; } .btn-secondary { padding: 0.5rem 1rem; background-color: #f1f5f9; color: #334155; border: 1px solid #cbd5e1; border-radius: 0.375rem; font-weight: 500; } .btn-secondary:hover { background-color: #e2e8f0; }"})]})},S=({file:s,onClose:l})=>{if(!s)return null;const a=s.url||("dataUrl"in s?s.dataUrl:void 0);return e.jsx(N,{isOpen:!!s,onClose:l,title:`תצוגה מקדימה: ${s.name}`,size:"xl",children:e.jsx("div",{className:"w-full h-[75vh] bg-slate-200 rounded-md",children:a&&s.mimeType.startsWith("image/")?e.jsx("img",{src:a,alt:s.name,className:"w-full h-full object-contain"}):a&&s.mimeType==="application/pdf"?e.jsx("iframe",{src:a,title:s.name,className:"w-full h-full border-0"}):e.jsx("div",{className:"flex items-center justify-center h-full text-slate-600",children:e.jsx("p",{children:"לא ניתן להציג תצוגה מקדימה עבור קובץ מסוג זה."})})})})},H=({file:s,onView:l,onDelete:a,onEdit:c,onAnnotate:m,onRenew:r,onDeleteHistory:d,className:j,style:h})=>{const[i,n]=p.useState(!1),[o,x]=p.useState(null),u=T(s.dueDate),f=({item:t})=>e.jsx("div",{className:"p-2 bg-slate-100 rounded-md text-xs",children:e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsxs("div",{children:[e.jsxs("p",{children:[e.jsx("strong",{children:"תאריך העלאה:"})," ",b(t.uploadedAt)]}),e.jsxs("p",{children:[e.jsx("strong",{children:"תוקף עד:"})," ",t.dueDate?b(t.dueDate):"N/A"]})]}),e.jsxs("div",{className:"flex items-center",children:[E(t.mimeType)&&e.jsx("button",{onClick:()=>x(t),className:"p-2 text-slate-500 hover:text-slate-700 rounded-full hover:bg-slate-200",title:"צפה בקובץ",children:e.jsx(g,{className:"w-4 h-4"})}),t.url&&e.jsx("a",{href:t.url,download:t.name,className:"p-2 text-sky-600 hover:bg-sky-100 rounded-full",title:"הורד גרסה ישנה",children:e.jsx(v,{className:"w-4 h-4"})}),d&&e.jsx("button",{onClick:()=>d(s.id,t.id),className:"p-2 text-red-500 hover:bg-red-100 rounded-full",title:"מחק גרסה",children:e.jsx(y,{className:"w-4 h-4"})})]})]})});return e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:`bg-white shadow-md rounded-lg p-3 border border-slate-200/60 transition-shadow hover:shadow-lg ${j||""}`,style:h,children:[e.jsxs("div",{className:"flex justify-between items-center gap-4",children:[e.jsxs("div",{className:"flex-grow min-w-0",children:[e.jsxs("div",{className:"flex items-center gap-2 flex-wrap mb-1",children:[e.jsx("p",{className:"font-semibold text-slate-800 truncate",title:s.name,children:s.name}),e.jsx("span",{className:`px-2 py-0.5 text-xs font-medium rounded-full ${u.bg} ${u.color}`,children:u.text})]}),e.jsxs("div",{className:"flex items-center gap-3 text-xs text-slate-500",children:[s.group&&e.jsxs("span",{children:["קבוצה: ",s.group]}),s.dueDate&&e.jsxs("span",{children:["תוקף: ",b(s.dueDate)]})]})]}),e.jsxs("div",{className:"flex items-center flex-shrink-0",children:[l&&e.jsx("button",{onClick:l,className:"p-2 text-slate-500 hover:text-slate-700 rounded-full hover:bg-slate-100",title:"צפה בקובץ",children:e.jsx(g,{className:"w-5 h-5"})}),e.jsx("a",{href:s.url||s.dataUrl,download:s.name,className:"p-2 text-slate-500 hover:text-slate-700 rounded-full hover:bg-slate-100",title:"הורד קובץ",children:e.jsx(v,{className:"w-5 h-5"})}),s.mimeType.startsWith("image/")&&m&&e.jsx("button",{onClick:m,className:"p-2 text-slate-500 hover:text-sky-600 rounded-full hover:bg-sky-50",title:"ערוך תמונה",children:e.jsx(w,{className:"w-5 h-5"})}),c&&e.jsx("button",{onClick:c,className:"p-2 text-slate-500 hover:text-sky-600 rounded-full hover:bg-sky-50",title:"ערוך פרטים",children:e.jsx(k,{className:"w-5 h-5"})}),e.jsx("button",{onClick:a,className:"p-2 text-slate-500 hover:text-red-600 rounded-full hover:bg-red-50",title:"מחק קובץ",children:e.jsx(y,{className:"w-5 h-5"})})]})]}),e.jsxs("div",{className:"flex items-center justify-between mt-2 pt-2 border-t border-slate-100",children:[e.jsx("div",{className:"flex items-center gap-2",children:s.history&&s.history.length>0&&e.jsxs("button",{onClick:()=>n(!i),className:"text-xs flex items-center gap-1 text-slate-500 hover:text-sky-600 font-medium",children:[i?"הסתר היסטוריה":"הצג היסטוריה",i?e.jsx(C,{className:"w-3 h-3"}):e.jsx(F,{className:"w-3 h-3"})]})}),r&&e.jsx("button",{onClick:()=>r(s),className:`text-sm font-semibold text-white px-3 py-1 rounded-md ${u.isExpired?"bg-amber-500 hover:bg-amber-600":"bg-sky-500 hover:bg-sky-600"}`,children:"חדש קובץ"})]}),i&&s.history&&e.jsx("div",{className:"mt-3 space-y-2",children:s.history.map(t=>e.jsx(f,{item:t},t.id))})]}),e.jsx(S,{file:o,onClose:()=>x(null)})]})};export{$ as E,H as F,E as i};
