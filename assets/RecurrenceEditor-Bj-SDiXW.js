import{r as d,aV as f,aW as p,aX as b,j as a,aY as S,av as C}from"./index-BU7E-q7q.js";import{b as j,f as o}from"./dateFormatter-CUKId3Gl.js";const k=l=>{if(!l)return new Date().toISOString().split("T")[0];try{return new Date(l).toISOString().split("T")[0]}catch{return new Date().toISOString().split("T")[0]}},O=({type:l,details:m,onUpdate:n})=>{const{recurrenceType:r="one-time",recurrence:s={unit:"years",interval:1,month:1,day:15},duration:t={unit:"days",value:60},startDate:N}=m,[c,y]=d.useState(k(N));d.useEffect(()=>{l==="file"&&r==="recurring"&&(t.unit!==s.unit||t.value!==s.interval)&&n({recurrence:{...s,unit:t.unit,interval:t.value}})},[l,r,t,s,n]),d.useEffect(()=>{const e=new Date(c);e.setHours(12,0,0,0);let i;r==="one-time"?i=e:i=j(e,t),n({startDate:e.toISOString(),dueDate:i?.toISOString()})},[c,r,t,n]);const D=d.useMemo(()=>{const e=new Date(c);e.setHours(12,0,0,0);const i=l==="file"?"תוקף הקובץ":"המשימה",I=l==="file"?"מתחיל":"תתחיל",$=`ונשארת פתוחה ל-${t.value} ${f.find(u=>u.value===t.unit)?.label}`;if(r==="one-time")return`${i} ${I} ב-${o(e)}.`;const w=s.interval,x=p.find(u=>u.value===s.unit)?.label,v=s.day,h=b.find(u=>u.value===s.month)?.label,g=j(e,t);return l==="file"?`הקובץ תקף החל מ-${o(e)} למשך ${t.value} ${x}. הוא יפוג ב-${o(g)} ויתחדש אוטומטית.`:`${i} מתחדש כל ${w} ${x}${s.unit==="years"&&h&&v?` ב-${v} ל${h}`:""}. ביצוע ראשון ב-${o(e)}. ${$} ותפוגה ב-${o(g)}.`},[r,s,t,c,l]);return a.jsxs("div",{className:"space-y-4 p-3 bg-slate-100 rounded-lg border",children:[a.jsx("div",{className:"flex items-center justify-center p-1 bg-slate-200 rounded-lg",children:["recurring","one-time"].map(e=>a.jsx("button",{type:"button",onClick:()=>n({recurrenceType:e}),className:`w-full py-2 text-sm font-semibold rounded-md transition-colors ${r===e?"bg-white shadow text-sky-700":"text-slate-600 hover:bg-slate-300/50"}`,children:e==="recurring"?"מחזורי":"חד פעמי"},e))}),r==="recurring"?a.jsxs("div",{className:"space-y-3 animate-fadeIn",children:[a.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-2",children:[l==="todo"&&a.jsxs("div",{children:[a.jsx("label",{className:"label-class",children:"חוזר כל"}),a.jsxs("div",{className:"flex gap-2",children:[a.jsx("input",{type:"number",min:"1",value:s.interval,onChange:e=>n({recurrence:{...s,interval:parseInt(e.target.value)||1}}),className:"input-class w-1/2"}),a.jsx("select",{value:s.unit,onChange:e=>n({recurrence:{...s,unit:e.target.value}}),className:"input-class w-1/2",children:p.map(e=>a.jsx("option",{value:e.value,children:e.label},e.value))})]})]}),a.jsxs("div",{children:[a.jsx("label",{className:"label-class",children:l==="file"?"תקף למשך":"נשאר פתוח ל-"}),a.jsxs("div",{className:"flex gap-2",children:[a.jsx("input",{type:"number",min:"1",value:t.value,onChange:e=>n({duration:{...t,value:parseInt(e.target.value)||1}}),className:"input-class w-1/2"}),a.jsx("select",{value:t.unit,onChange:e=>n({duration:{...t,unit:e.target.value}}),className:"input-class w-1/2",children:f.map(e=>a.jsx("option",{value:e.value,children:e.label},e.value))})]})]})]}),s.unit==="years"&&l==="todo"&&a.jsxs("div",{className:"grid grid-cols-2 gap-2",children:[a.jsxs("div",{children:[a.jsx("label",{className:"label-class",children:"בחודש"}),a.jsx("select",{value:s.month,onChange:e=>n({recurrence:{...s,month:parseInt(e.target.value)}}),className:"input-class",children:b.map(e=>a.jsx("option",{value:e.value,children:e.label},e.value))})]}),a.jsxs("div",{children:[a.jsx("label",{className:"label-class",children:"ביום"}),a.jsx("select",{value:s.day,onChange:e=>n({recurrence:{...s,day:parseInt(e.target.value)}}),className:"input-class",children:Array.from({length:31},(e,i)=>i+1).map(e=>a.jsx("option",{value:e,children:e},e))})]})]})]}):null,a.jsxs("div",{children:[a.jsx("label",{className:"label-class",children:r==="recurring"?"תאריך התחלה ראשון":"תאריך יעד"}),a.jsxs("div",{className:"relative",children:[a.jsx("input",{type:"date",value:c,onChange:e=>y(e.target.value),className:"input-class w-full pr-10"}),a.jsx("div",{className:"pointer-events-none absolute inset-y-0 right-0 flex items-center pr-3",children:a.jsx(S,{className:"h-5 w-5 text-gray-400"})})]})]}),a.jsxs("div",{className:"flex items-start gap-2 p-3 bg-sky-50 border-r-4 border-sky-400 rounded-md",children:[a.jsx(C,{className:"w-5 h-5 text-sky-600 flex-shrink-0 mt-0.5"}),a.jsx("p",{className:"text-sm text-sky-800",children:D})]}),a.jsx("style",{children:`
                .label-class { display: block; text-align: right; margin-bottom: 0.25rem; font-size: 0.8rem; font-weight: 500; color: #475569; }
                .input-class { display: block; width: 100%; border: 1px solid #cbd5e1; border-radius: 0.375rem; padding: 0.5rem 0.75rem; font-size: 0.875rem; }
                .animate-fadeIn { animation: fadeIn 0.3s ease-out; }
                @keyframes fadeIn { from { opacity: 0; transform: translateY(-5px); } to { opacity: 1; translateY(0); } }
            `})]})};export{O as R};
